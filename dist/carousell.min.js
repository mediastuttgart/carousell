/*! Carousell | version 0.1.0 (08-09-2013) | author: Michael Alexander Freund | license: MIT License (http://www.opensource.org/licenses/mit-license.php) */
!function(a){"use strict";function b(a,c){for(var d in c)a[d]="object"==typeof c[d]?b(a[d],c[d]):c[d];return a}function c(a){return"[object Array]"===g.call(a)}function d(a){var b=[];if(c(a))b=a;else if("number"==typeof a.length)for(var d=0,e=a.length;e>d;d++)b.push(a[d]);else b.push(a);return b}function e(c){function e(a,c,f){var g=this;return g instanceof e?("string"==typeof a&&(a=document.querySelectorAll(a)),g.elements=d(a),g.options=b({animationSpeed:.5,showBullets:!1},g.options),g.options.hammer=b({drag_lock_to_axis:!0},g.options.hammer),"function"==typeof c?f=c:b(g.options,c),f&&g.on("ready",f),g.initCarousell(),void 0):new e(a,c,f)}return e.prototype=new c,e.prototype.initCarousell=function(){for(var a=this,b=0,c=a.elements.length;c>b;b++){var d=this.elements[b].getElementsByTagName("ul")[0]||this.elements[b].getElementsByTagName("ol")[0];if(void 0===d)return!1;d.panes=[];for(var e=d.children,f=e.length,g=0;f>g;g++)"LI"===e[g].tagName&&(d.panes[g]=e[g]);if(0===d.panes.length)return!1;d.paneWidth=0,d.paneCount=d.panes.length,d.currentPane=0,d.offset=0,d.classNames=d.className,a.setDimensions(d),a.bindEvents(d),a.showPane(d.currentPane,d,!1,!0),a.onReady(d)}},e.prototype.setDimensions=function(a){a.paneWidth=a.parentNode.offsetWidth;for(var b=0;b<a.paneCount;b++)a.panes[b].style.width=a.paneWidth+"px";a.style.width=a.paneWidth*a.paneCount+"px"},e.prototype.bindEvents=function(b){var c=this;eventie.bind(a,"resize",function(){c.setDimensions(b),c.showPane(b.currentPane,b,!1,!1)}),b.hammer=new Hammer(b,c.options.hammer),b.hammer.on("release dragleft dragright swipeleft swiperight",function(a){c.handleGestures(a,b)}),b.hammer.on("dragstart",function(){b.className="dragging "+b.classNames}),b.hammer.on("release swipeleft swiperight",function(){b.className=b.classNames})},e.prototype.showPane=function(a,b,c,d){var e=this,f=Math.max(0,Math.min(a,b.paneCount-1)),g=-(100/b.paneCount*f);b.currentPane=f,e.setOffset(g,b,c,d)},e.prototype.setOffset=function(a,b,c,d){var e=this,f=b.paneWidth*b.paneCount/100*a,g=c?e.options.animationSpeed:0;TweenMax.to(b,g,{left:f,ease:Expo.easeOut,onComplete:function(){d&&e.onAnimationComplete(b)}})},e.prototype.handleGestures=function(a,b){var c=this;switch(a.gesture.preventDefault(),a.gesture.stopPropagation(),a.type){case"dragright":case"dragleft":var d=-(100/b.paneCount)*b.currentPane,e=100/b.paneWidth*a.gesture.deltaX/b.paneCount;(0===b.currentPane&&a.gesture.direction===Hammer.DIRECTION_RIGHT||b.currentPane===b.paneCount-1&&a.gesture.direction===Hammer.DIRECTION_LEFT)&&(e*=.4),c.setOffset(e+d,b,!1,!1);break;case"swipeleft":c.next(b),a.gesture.stopDetect();break;case"swiperight":c.prev(b),a.gesture.stopDetect();break;case"release":Math.abs(a.gesture.deltaX)>b.paneWidth/2?"right"===a.gesture.direction?c.prev(b):c.next(b):c.showPane(b.currentPane,b,!0,!1)}},e.prototype.prev=function(a){var b=this;0!==a.currentPane?b.showPane(a.currentPane-1,a,!0,!0):b.showPane(a.currentPane,a,!0,!1)},e.prototype.next=function(a){var b=this;a.currentPane+1!==a.paneCount?b.showPane(a.currentPane+1,a,!0,!0):b.showPane(a.currentPane,a,!0,!1)},e.prototype.onReady=function(a){var b=this;setTimeout(function(){b.emit("ready",b,a)})},e.prototype.onAnimationComplete=function(a){var b=this;a.className=a.classNames,setTimeout(function(){b.emit("animationComplete",b,a)})},f&&(f.fn.Carousell=function(a,b){return new e(this,a,b)}),e}var f=a.jQuery,g=Object.prototype.toString;"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter"],e):a.Carousell=e(a.EventEmitter)}(window);